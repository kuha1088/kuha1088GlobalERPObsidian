Ошибка выполнения скрипта правила BisObjAccess при генерации значений для параметра SimpleAcObjectRuleParam
ru.bitec.engine.model.operation.OperationException: gtk-ru.bitec.app.bs.Bs_BisObj#Lookup.ONLOADADMINMETA
at ru.bitec.engine.model.operation.OperationAbst.onExecutorExecute(OperationAbst.java:1107)
at ru.bitec.engine.model.operation.OperationAbst.execute(OperationAbst.java:1031)
at ru.bitec.engine.model.operation.OperationAbst.execute(OperationAbst.java:1016)
at ru.bitec.engine.model.selection.SelectionImpl.executeOperation_(SelectionImpl.java:1642)
at ru.bitec.engine.model.selection.SelectionImpl.executeOperationByName_(SelectionImpl.java:1667)
at ru.bitec.engine.model.selection.SelectionImpl.executeOperationByName_(SelectionImpl.java:1658)
at ru.bitec.engine.model.selection.SelectionImpl.initSelectionDefaults(SelectionImpl.java:746)
at ru.bitec.engine.model.selection.ESelectionImpl$SelectionImpl_.initSelectionDefaults(ESelectionImpl.java:1672)
at ru.bitec.engine.model.selection.ESelectionImpl.doInitSelectionDefaults(ESelectionImpl.java:440)
at ru.bitec.engine.model.selection.ESelectionImpl.onBuild(ESelectionImpl.java:354)
at ru.bitec.engine.model.ENodeAbst.internalBuild(ENodeAbst.java:398)
at ru.bitec.engine.model.EBranchAbst.internalBuild(EBranchAbst.java:68)
at ru.bitec.engine.model.ENodeAbst.build(ENodeAbst.java:380)
at ru.bitec.engine.model.ui.editor.combobox.EComboBoxImpl.buildLookupESelection(EComboBoxImpl.java:215)
at ru.bitec.engine.model.ui.editor.combobox.EComboBoxImpl$EComboBoxControllerImpl.load(EComboBoxImpl.java:587)
at ru.bitec.engine.model.ui.editor.combobox.EComboBoxImpl$EComboBoxControllerImpl.onProcessCommand(EComboBoxImpl.java:510)
at ru.bitec.engine.model.ui.editor.ETagComboBoxImpl$ETagComboBoxControllerImpl.onProcessCommand(ETagComboBoxImpl.java:167)
at ru.bitec.engine.model.ENodeAbst$ENodeControllerAbst.processCommand(ENodeAbst.java:794)
at ru.bitec.engine.command.ECommandManagerImpl.lambda$handleCommand$0(ECommandManagerImpl.java:154)
at ru.bitec.engine.telemetry.SpanController.lambda$forCurrentLazySpan$10(SpanController.java:338)
at ru.bitec.engine.telemetry.SpanController.lambda$forLazySpan$6(SpanController.java:243)
at ru.bitec.jvm.util.call.TryAbst.call(TryAbst.java:131)
at ru.bitec.jvm.util.call.TryAbst.access$000(TryAbst.java:17)
at ru.bitec.jvm.util.call.TryAbst$2.call(TryAbst.java:118)
at ru.bitec.engine.telemetry.SpanController.forLazySpan(SpanController.java:245)
at ru.bitec.engine.telemetry.SpanController.forCurrentLazySpan(SpanController.java:336)
at ru.bitec.engine.command.ECommandManagerImpl.handleCommand(ECommandManagerImpl.java:153)
at ru.bitec.common.event.EventSourceAbst$1.handleEvent(EventSourceAbst.java:54)
at ru.bitec.common.event.EventSourceImpl.fireEvent(EventSourceImpl.java:10)
at ru.bitec.common.event.EventSourceAbst.fireEvent(EventSourceAbst.java:125)
at ru.bitec.engine.command.ECommandProtocolImpl.read(ECommandProtocolImpl.java:31)
at ru.bitec.engine.session.ClientConnectionImpl$1.execute(ClientConnectionImpl.java:423)
at ru.bitec.jvm.actor.AsactorThreadImpl$MessageHandlerImpl_.handleMessage(AsactorThreadImpl.java:720)
at ru.bitec.jvm.actor.AsactorThreadImpl.processMessage(AsactorThreadImpl.java:638)
at ru.bitec.jvm.actor.AsactorThreadImpl.processMessages(AsactorThreadImpl.java:519)
at ru.bitec.jvm.actor.AsactorThreadImpl.onRun(AsactorThreadImpl.java:325)
at ru.bitec.common.actor.ActorAbst.run(ActorAbst.java:107)
at ru.bitec.jvm.util.call.TryFinally.call(TryFinally.java:73)
at ru.bitec.jvm.util.call.TryFinally.call(TryFinally.java:36)
at ru.bitec.engine.session.AsactorThreadBuilderImpl.lambda$null$0(AsactorThreadBuilderImpl.java:21)
at ru.bitec.jvm.util.call.Safe.call(Safe.java:16)
at ru.bitec.engine.session.AsactorThreadBuilderImpl.lambda$newThread$1(AsactorThreadBuilderImpl.java:21)
at java.lang.Thread.run(Thread.java:750)
Caused by: ru.bitec.app.gtk.exception.AppException: Ошибка выполнения скрипта правила BisObjAccess при генерации значений для параметра SimpleAcObjectRuleParam
at ru.bitec.app.gtk.exception.AppException$$anonfun$$lessinit$greater$1.apply(AppException.scala:79)
at ru.bitec.app.gtk.exception.AppException$$anonfun$$lessinit$greater$1.apply(AppException.scala:79)
at ru.bitec.app.gtk.exception.ExceptionFactory.apply(ExceptionFactory.scala:17)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$13(Btk_AdminPkg.scala:1902)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$13$adapted(Btk_AdminPkg.scala:1886)
at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:469)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$12(Btk_AdminPkg.scala:1886)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$12$adapted(Btk_AdminPkg.scala:1869)
at ru.bitec.app.gtk.lang.json.JObject$.$anonfun$foreach$1(JObject.scala:332)
at java.util.HashMap.forEach(HashMap.java:1290)
at ru.bitec.app.gtk.lang.json.JObject$.foreach$extension(JObject.scala:331)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$11(Btk_AdminPkg.scala:1869)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$11$adapted(Btk_AdminPkg.scala:1861)
at ru.bitec.app.gtk.lang.json.JArray$.$anonfun$foreach$1(JArray.scala:369)
at java.util.ArrayList.forEach(ArrayList.java:1259)
at ru.bitec.app.gtk.lang.json.JArray$.foreach$extension(JArray.scala:368)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$10(Btk_AdminPkg.scala:1861)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$10$adapted(Btk_AdminPkg.scala:1847)
at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$8(Btk_AdminPkg.scala:1847)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$8$adapted(Btk_AdminPkg.scala:1836)
at ru.bitec.app.gtk.lang.json.JArray$.$anonfun$foreach$1(JArray.scala:369)
at java.util.ArrayList.forEach(ArrayList.java:1259)
at ru.bitec.app.gtk.lang.json.JArray$.foreach$extension(JArray.scala:368)
at ru.bitec.app.btk.Btk_AdminPkg.calcRulesAndParams(Btk_AdminPkg.scala:1836)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$1(Btk_AdminPkg.scala:1703)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$1$adapted(Btk_AdminPkg.scala:1702)
at scala.collection.immutable.Set$Set2.foreach(Set.scala:210)
at ru.bitec.app.btk.Btk_AdminPkg.calcRulesAndParams(Btk_AdminPkg.scala:1702)
at ru.bitec.app.btk.Btk_AdminPkg.generateDiscreteAccessMacros(Btk_AdminPkg.scala:2097)
at ru.bitec.app.btk.ac.role.priv.Btk_AcLib.$anonfun$applyObjectDiscreteRights$1(Btk_AcLib.scala:92)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$withForceDiscrete$1(Btk_AdminPkg.scala:98)
at ru.bitec.app.gtk.exception.App$.apply(App.scala:25)
at ru.bitec.app.btk.Btk_AdminPkg.withForceDiscrete(Btk_AdminPkg.scala:96)
at ru.bitec.app.btk.Btk_AdminPkg.withCheckUsingDiscreteAccess(Btk_AdminPkg.scala:83)
at ru.bitec.app.btk.ac.role.priv.Btk_AcLib.applyObjectDiscreteRights(Btk_AcLib.scala:91)
at ru.bitec.app.btk.gl.EntityAvi$EntityAviDefault.onLoadAdminMeta(EntityAvi.scala:2606)
at ru.bitec.app.btk.gl.EntityAvi$EntityAviDefault.onLoadAdminMeta$(EntityAvi.scala:2603)
at ru.bitec.app.bs.Bs_BisObjAvi$$anon$3.onLoadAdminMeta(Bs_BisObjAvi.scala:28)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at ru.bitec.app.gtk.gl.handler.DefaultRepHandler.invoke(DefaultRepHandler.scala:51)
at ru.bitec.app.gtk.gl.handler.RepHandlersImpl$RepHandlerInterceptor.$anonfun$invoke$1(RepHandlersImpl.scala:286)
at ru.bitec.app.gtk.exception.App$.apply(App.scala:25)
at ru.bitec.app.gtk.gl.handler.RepHandlersImpl$RepHandlerInterceptor.invoke(RepHandlersImpl.scala:285)
at ru.bitec.app.gtk.gl.RepControllerImpl$CoreOperationExecutorImpl.$anonfun$invoke$1(RepControllerImpl.scala:35)
at ru.bitec.app.gtk.gl.RepControllerImpl.ru$bitec$app$gtk$gl$RepControllerImpl$$usingSbtClassLoaderAsContext(RepControllerImpl.scala:81)
at ru.bitec.app.gtk.gl.RepControllerImpl$CoreOperationExecutorImpl.invoke(RepControllerImpl.scala:35)
at sun.reflect.GeneratedMethodAccessor1465.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at ru.bitec.jvm.mock.ProxyBuilder$StubMethod.invoke(ProxyBuilder.java:173)
at ru.bitec.jvm.mock.ProxyBuilder$1.invoke(ProxyBuilder.java:117)
at com.sun.proxy.$Proxy189.invoke(Unknown Source)
at ru.bitec.engine.model.operation.executor.ScriptExecutorImpl.lambda$execute$2(ScriptExecutorImpl.java:174)
at ru.bitec.engine.model.operation.OperationManagerImpl.callUsingOperationStack(OperationManagerImpl.java:891)
at ru.bitec.engine.model.operation.executor.ScriptExecutorImpl.execute(ScriptExecutorImpl.java:174)
at ru.bitec.engine.model.operation.executor.ScriptExecutorImpl.execute(ScriptExecutorImpl.java:95)
at ru.bitec.engine.model.operation.OperationAbst.onExecute(OperationAbst.java:1200)
at ru.bitec.engine.model.operation.OperationAbst.lambda$null$0(OperationAbst.java:1038)
at ru.bitec.jvm.util.call.TryFinally.call(TryFinally.java:217)
at ru.bitec.engine.connection.ConnectionAbst.forUserAction(ConnectionAbst.java:316)
at ru.bitec.engine.connection.ConnectionAbst.forUserAction(ConnectionAbst.java:311)
at ru.bitec.engine.model.operation.OperationAbst.lambda$execute$1(OperationAbst.java:1032)
at ru.bitec.engine.model.operation.OperationAbst.onExecutorExecute(OperationAbst.java:1093)
... 42 more
Caused by: ru.bitec.app.gtk.exception.AppException: ru.bitec.app.gtk.jexl.JexlBasic.compile:77@7:13 variable 'idvBisObj' is undefined
at ru.bitec.app.gtk.exception.AppException$$anonfun$$lessinit$greater$1.apply(AppException.scala:79)
at ru.bitec.app.gtk.exception.AppException$$anonfun$$lessinit$greater$1.apply(AppException.scala:79)
at ru.bitec.app.gtk.exception.ExceptionFactory.fromString(ExceptionFactory.scala:23)
at ru.bitec.app.gtk.exception.App$.apply(App.scala:31)
at ru.bitec.app.btk.jexl.Btk_JexlScriptSafePkg.withSafeDisabled(Btk_JexlScriptSafePkg.scala:60)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$14(Btk_AdminPkg.scala:1898)
at ru.bitec.app.gtk.exception.App$.apply(App.scala:25)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$13(Btk_AdminPkg.scala:1895)
... 107 more
Caused by: org.apache.commons.jexl3.JexlException$Variable: ru.bitec.app.gtk.jexl.JexlBasic.compile:77@7:13 variable 'idvBisObj' is undefined
at ru.bitec.app.gtk.jexl.JexlCompiledScript.executeContext(JexlBasic.scala:195)
at ru.bitec.app.gtk.jexl.JexlCompiledScript.eval(JexlBasic.scala:310)
at ru.bitec.app.gtk.jexl.JexlBasic.eval(JexlBasic.scala:115)
at ru.bitec.app.btk.Btk_AdminPkg.$anonfun$calcRulesAndParams$15(Btk_AdminPkg.scala:1897)
at ru.bitec.app.btk.jexl.Btk_JexlScriptSafePkg.$anonfun$withSafeDisabled$1(Btk_JexlScriptSafePkg.scala:62)
at ru.bitec.app.gtk.exception.App$.apply(App.scala:25)
... 111 more